# Machine-learning-and-porgraming

# ðŸ”‹ LSTM ê¸°ë°˜ ê³µìž‘ê¸°ê³„ ì—ë„ˆì§€ ì†Œë¹„ ì˜ˆì¸¡

ë³¸ í”„ë¡œì íŠ¸ëŠ” LSTM(Long Short-Term Memory) ëª¨ë¸ì„ í™œìš©í•˜ì—¬ ê³µìž‘ê¸°ê³„ì˜ ì„¼ì„œ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì „ë ¥ ì†Œë¹„(`pwr`)ë¥¼ ì˜ˆì¸¡í•˜ëŠ” ì‹œê³„ì—´ ë”¥ëŸ¬ë‹ ëª¨ë¸ìž…ë‹ˆë‹¤.

## ðŸ“ í”„ë¡œì íŠ¸ í´ë” êµ¬ì¡°
 ``` project_root/
â”œâ”€â”€ data/
â”‚ â”œâ”€â”€ train_file_1.csv
â”‚ â”œâ”€â”€ train_file_2.csv
â”‚ â”œâ”€â”€ train_file_3.csv
â”‚ â””â”€â”€ test_file.csv
â”‚
â”œâ”€â”€ results/
â”‚ â”œâ”€â”€ models/
â”‚ â”œâ”€â”€ scalers/
â”‚ â””â”€â”€ predictions/
â”‚
â”œâ”€â”€ lstm_train_predict.py
â”œâ”€â”€ README.md
â””â”€â”€ requirements.txt
 ``` 
---
### â³ ì‹œê³„ì—´ ëª¨ë¸ êµ¬ì¡° ì„¤ëª…

- ë³¸ LSTM ëª¨ë¸ì€ ì‹œê³„ì—´ ì˜ˆì¸¡ ê¸°ë°˜ìœ¼ë¡œ, `SEQ_LEN=20`, `LAG=10`ì„ ì„¤ì •í•˜ì—¬ êµ¬ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.
- `SEQ_LEN=20`ì€ 20ê°œ ì—°ì†ëœ ì‹œì ì˜ í”¼ì²˜ ë°ì´í„°ë¥¼ ìž…ë ¥ ì‹œí€€ìŠ¤ë¡œ ì‚¬ìš©í•œë‹¤ëŠ” ì˜ë¯¸ì´ë©°,
- `LAG=10`ì€ ì˜ˆì¸¡ íƒ€ê¹ƒ ì‹œì ì´ ìž…ë ¥ ì‹œí€€ìŠ¤ë³´ë‹¤ 10 íƒ€ìž„ìŠ¤í… ë’¤ì— ì¡´ìž¬í•¨ì„ ì˜ë¯¸í•©ë‹ˆë‹¤.

- ì´ì™€ ê°™ì€ LAG ì„¤ì •ì€ ë‹¨ìˆœ ì‹œê°„ ì§€ì—°ì´ ì•„ë‹ˆë¼, **ê³µìž‘ê¸°ê³„ì— ë¶€ì°©ëœ ì„¼ì„œë“¤ì˜ ì‹¤ì œ ìˆ˜ì§‘ ì§€ì—°(delay) í˜„ìƒì„ ë°˜ì˜**í•˜ê¸° ìœ„í•œ ê²ƒìœ¼ë¡œ,
  ì˜ˆì¸¡ ëŒ€ìƒ ì „ë ¥ ì†Œë¹„ê°€ ë¬¼ë¦¬ì ìœ¼ë¡œ ë°œìƒí•˜ëŠ” ì‹œì ê³¼ ë°ì´í„°ê°€ ê¸°ë¡ë˜ëŠ” ì‹œì  ê°„ì˜ ê°„ê·¹ì„ ëª¨ë¸ì— í•™ìŠµì‹œí‚¤ê¸° ìœ„í•¨ìž…ë‹ˆë‹¤.

- ê²°ê³¼ì ìœ¼ë¡œ, `[t ~ t+19]` ì‹œí€€ìŠ¤ë¥¼ ìž…ë ¥í•˜ë©´ `t+30` ì‹œì ì˜ ì „ë ¥ ì†Œë¹„(`pwr`)ë¥¼ ì˜ˆì¸¡í•˜ê²Œ ë©ë‹ˆë‹¤.

### âš ï¸ Idle Power ì²˜ë¦¬ ë°©ì‹

- ë³¸ ëª¨ë¸ì€ ì „ë ¥ ì†Œë¹„ ì˜ˆì¸¡ ì‹œ, **ë¹„ê°€ê³µ(idle) êµ¬ê°„ì˜ ì „ë ¥ë„ í¬í•¨í•˜ë˜**,  
  ì´ë¥¼ ê·¸ëŒ€ë¡œ ì˜ˆì¸¡ íƒ€ê¹ƒìœ¼ë¡œ ì‚¬ìš©í•˜ì§€ ì•Šê³  **ì‚¬ì „ ë³´ì •ëœ ê°’**ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.

- ì‹¤ì œë¡œëŠ” idle ìƒíƒœì˜ ì†Œë¹„ì „ë ¥ì´ ì¡´ìž¬í•˜ë©°, **KITECH ê³µìž‘ê¸°ê³„ ê¸°ì¤€ ì•½ 0.4 kW**ìž…ë‹ˆë‹¤.

- ë”°ë¼ì„œ, ì›ë³¸ ë°ì´í„°ì—ì„œ ê°€ê³µ ì¤‘ì´ ì•„ë‹Œ êµ¬ê°„ì˜ ì „ë ¥ê°’ì€ **0ì´ ì•„ë‹ˆë¼, ì•½ 0.4kW ìˆ˜ì¤€**ì˜ ìƒìˆ˜ì´ë©°,  
  ì´ ê°’ì„ ì˜ˆì¸¡ì— í¬í•¨ì‹œí‚¤ë©´ ì˜¤ì°¨ê°€ ì™œê³¡ë  ìˆ˜ ìžˆê¸° ë•Œë¬¸ì—, **ì „ì²´ ì „ë ¥ì—ì„œ idle ì „ë ¥(0.4 kW)ì„ ì°¨ê°í•˜ì—¬ ìˆœìˆ˜ ê°€ê³µ ì¤‘ ì†Œë¹„ ì „ë ¥ë§Œì„ ëª¨ë¸ì˜ ì˜ˆì¸¡ íƒ€ê¹ƒìœ¼ë¡œ ì‚¬ìš©**í•˜ì˜€ìŠµë‹ˆë‹¤.

- ë˜í•œ, `is_cut_active`ë¼ëŠ” ì´ì§„ í”¼ì²˜ë¥¼ ì¶”ê°€í•˜ì—¬,  
  ëª¨ë¸ì´ ì ˆì‚­(active) êµ¬ê°„ê³¼ ë¹„ì ˆì‚­(idle) êµ¬ê°„ì„ í•™ìŠµ ì¤‘ ëª…í™•ížˆ êµ¬ë¶„í•  ìˆ˜ ìžˆë„ë¡ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤.


## âš™ï¸ ì‹¤í–‰ ë°©ë²•

### 1. ì½”ë“œ ì‹¤í–‰ í™˜ê²½ ì¤€ë¹„

- Python 3.8 ì„¤ì¹˜ (Anaconda í™˜ê²½ ì‚¬ìš© ì‹œ ì•ˆì •ì )
- í•„ìš”í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜:

```bash
pip install -r requirements.txt
``` 

### 2. ì½”ë“œ ì„¤ëª…
- ê²½ë¡œ ì„¤ì •: ì½”ë“œ ìƒë‹¨ì— ìžˆëŠ” ê²½ë¡œë¥¼ ë¡œì»¬ í™˜ê²½ì— ë§žê²Œ ìˆ˜ì •í•´ì•¼ í•©ë‹ˆë‹¤.
- í•™ìŠµ ì¡°ê±´ ì„¤ì • : 1. í•™ìŠµ feature ì„¤ì • 2. target ì„¤ì • 3. Sequence ì„¤ì • (Seq_Len) 4. time delay ì„¤ì • (LAG) 5. í•™ìŠµíšŸìˆ˜ ì„¤ì • (NUM_SEEDS) 6. í•œë²ˆì— flotí•  ë°ì´í„° ê°œìˆ˜ ì„¤ì • (GROUP_SIZE)

### 3. ì½”ë“œ íë¦„ ìš”ì•½

1. **ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°**
   - ì„¸ ê°œì˜ í•™ìŠµìš© CSV íŒŒì¼ê³¼ í•˜ë‚˜ì˜ í…ŒìŠ¤íŠ¸ìš© CSV íŒŒì¼ì„ ë¶ˆëŸ¬ì˜´

2. **í”¼ì²˜ ìƒì„± ë° ì „ì²˜ë¦¬**
   - clx/clz ë“± ì ˆì‚­ë ¥ ë²¡í„°ì—ì„œ `force_norm`, `feed_norm`, `energy_proxy` íŒŒìƒ ë³€ìˆ˜ ìƒì„±
   - ì´ìƒì¹˜(IQR ë°©ì‹)ë¥¼ ì œê±°í•˜ì—¬ í•™ìŠµ ì•ˆì •ì„± í–¥ìƒ

3. **ìŠ¤ì¼€ì¼ë§**
   - `MinMaxScaler`ë¥¼ í†µí•´ feature ë° target ê°’ì„ 0~1 ë²”ìœ„ë¡œ ì •ê·œí™”
   - ì¶”í›„ ì˜ˆì¸¡ ê²°ê³¼ ì—­ë³€í™˜ì„ ìœ„í•´ ìŠ¤ì¼€ì¼ëŸ¬ë„ ì €ìž¥í•¨

4. **ì‹œí€€ìŠ¤ ìƒì„±**
   - LSTM ìž…ë ¥ì— ë§žê²Œ ì‹œê³„ì—´ ë°ì´í„°(`SEQ_LEN`)ë¥¼ ìŠ¬ë¼ì´ë”© ìœˆë„ìš° ë°©ì‹ìœ¼ë¡œ ì‹œí€€ìŠ¤í™”
   - ì˜ˆì¸¡ ì‹œì ì€ ì‹œí€€ìŠ¤ ê¸°ì¤€ `LAG`ë§Œí¼ ë’¤ì˜ ê°’ì„ íƒ€ê²Ÿìœ¼ë¡œ ì§€ì •

5. **ëª¨ë¸ í•™ìŠµ (ë°˜ë³µ)**
   - Seed ê°’ì„ 1~10ê¹Œì§€ ë‹¤ë¥´ê²Œ ì£¼ê³ , ë™ì¼í•œ êµ¬ì¡°ì˜ LSTM ëª¨ë¸ì„ ë°˜ë³µ í•™ìŠµ
   - ëª¨ë¸ì€ `2ì¸µ LSTM + Dense` êµ¬ì¡°ì´ë©°, `EarlyStopping`ì„ í†µí•´ ê³¼ì í•© ë°©ì§€
   - ê° ëª¨ë¸ì€ `.h5` í˜•ì‹ìœ¼ë¡œ ì €ìž¥ë¨

6. **ì˜ˆì¸¡ ë° ê²°ê³¼ ì €ìž¥**
   - í•™ìŠµëœ ëª¨ë¸ë¡œ í…ŒìŠ¤íŠ¸ ë°ì´í„°ë¥¼ ì˜ˆì¸¡í•˜ê³ , `MinMaxScaler`ë¥¼ ì´ìš©í•´ ì‹¤ì œ ë‹¨ìœ„ë¡œ ì—­ë³€í™˜
   - ì˜ˆì¸¡ ê²°ê³¼ëŠ” ì‹¤ì œ ê°’ê³¼ í•¨ê»˜ `.csv`ë¡œ ì €ìž¥ë¨

7. **ì‹œê°í™”**
   - ì˜ˆì¸¡ê°’ vs ì‹¤ì œê°’ì„ ë¼ì¸ ê·¸ëž˜í”„ë¡œ ê·¸ë ¤ ë¹„êµ
   - 5ê°œì”© ë¬¶ì–´ seed ê·¸ë£¹ ë‹¨ìœ„ë¡œ ì´ 2ê°œì˜ ê·¸ëž˜í”„ ì¶œë ¥


### 4. í•™ìŠµëª¨ë¸ ì„ ì •
LSTM í•™ìŠµëª¨ë¸ íŠ¹ì„±ìƒ ê°™ì€ íŒŒë¼ë¯¸í„°ë¡œ í•™ìŠµí•´ë„ ê²°ê³¼ê°€ ë‹¤ë¥´ê²Œ ì¶œë ¥ ë  ìˆ˜ ìžˆì–´ ìœ¡ì•ˆìœ¼ë¡œ í™•ì¸ ë˜ëŠ” ì •ëŸ‰ì  ì§€í‘œ ê¸°ì¤€ìœ¼ë¡œ ëª¨ë¸ì„ ì„ ì •í•˜ëŠ” ê³¼ì •ì´ í•„ìš”í•¨


## ðŸ“ˆ ì˜ˆì¸¡ ê²°ê³¼ ìš”ì•½

- ë³¸ ëª¨ë¸ì€ SM45Cì™€ AL6061 ì†Œìž¬ë¥¼ ëŒ€ìƒìœ¼ë¡œ ë‹¤ì–‘í•œ ê°€ê³µ ì¡°ê±´(ìŠ¬ë¡œíŒ…, ë“œë¦´ë§, íŽ˜ì´ìŠ¤ë°€ ë“±)ì—ì„œ ìˆ˜ì§‘ëœ ì‹œê³„ì—´ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•™ìŠµë˜ì—ˆìŠµë‹ˆë‹¤.
- ì˜ˆì¸¡ ëŒ€ìƒì€ ê³µìž‘ê¸°ê³„ ê°€ê³µ ì¤‘ ì‹¤ì‹œê°„ ì „ë ¥ ì†Œë¹„ëŸ‰ì´ë©°, ë‹¨ìœ„ëŠ” kWìž…ë‹ˆë‹¤.

- í‰ê·  ì˜ˆì¸¡ ì˜¤ì°¨ëŠ” ì•½ **0.3kW ì´í•˜**ë¡œ ë§¤ìš° ë‚®ì€ ìˆ˜ì¤€ì´ë©°,  
  íŠ¹ížˆ ê¸°ì¡´ RNN ëª¨ë¸ë¡œëŠ” ìž¡ížˆì§€ ì•Šë˜ **ì†Œë¹„ì „ë ¥ í”¼í¬ ì‹œì **ì„ ì •í™•ížˆ í¬ì°©í•  ìˆ˜ ìžˆì—ˆìŠµë‹ˆë‹¤.

- LSTM ëª¨ë¸ ë„ìž… ë° `is_cut_active`, `energy_proxy`, ì†Œìž¬ë¹„(cutting ratio) ë“± **3ê°€ì§€ í”¼ì²˜ ì¶”ê°€**ê°€ ì˜ˆì¸¡ ì •í™•ë„ í–¥ìƒì— í° ê¸°ì—¬ë¥¼ í–ˆìŠµë‹ˆë‹¤.

- ì—ë„ˆì§€ ì†Œë¹„ ì´ëŸ‰ ì˜ˆì¸¡ ì •í™•ë„ëŠ” ë‹¤ì†Œ ë–¨ì–´ì§ˆ ìˆ˜ ìžˆì§€ë§Œ, **íŒ¨í„´ ì¶”ì  ì„±ëŠ¥(RÂ² ê¸°ì¤€)**ì€ ì‹œê°ì ìœ¼ë¡œ ë§Œì¡±í•  ë§Œí•œ ìˆ˜ì¤€ìž…ë‹ˆë‹¤.

- ì•„ëž˜ëŠ” ì˜ˆì¸¡ê°’ê³¼ ì‹¤ì œê°’ì˜ ì‹œê°í™” ì˜ˆì‹œìž…ë‹ˆë‹¤:
  - ê²€ì€ì„  = ì‹¤ì œ ì „ë ¥ ì†Œë¹„
  - ì»¬ëŸ¬ ì„  = seedë³„ LSTM ì˜ˆì¸¡ê°’
  - 5ê°œì”© ë¬¶ì–´ì„œ ì´ 2ê°œì˜ ë¹„êµ ê·¸ëž˜í”„ ì œê³µë¨

- Idle ìƒíƒœ ì „ë ¥(ì•½ 0.4kW)ì„ ì‚¬ì „ì— ì œê±°í•œ **ìˆœìˆ˜ ê°€ê³µ êµ¬ê°„ ì „ë ¥**ë§Œì„ ì˜ˆì¸¡ ëŒ€ìƒìœ¼ë¡œ ì„¤ì •í•˜ì˜€ìŠµë‹ˆë‹¤.

### ðŸ”¢ ëª¨ë¸ ì„±ëŠ¥ ìš”ì•½ (Toolë³„)

| Tool           | RMSE (kW) | MAE (kW) | RÂ²     |
|----------------|-----------|----------|--------|
| Facemill       | 0.1941    | 0.1325   | 0.7039 |
| 10pi Flat      | 0.9721    | 0.2331   | -1.0278 |
| 16pi Flat      | 0.3098    | 0.1456   | 0.3619 |
| 10pi Drill     | 0.4519    | 0.2058   | 0.6558 |
| 16pi Drill     | 0.4922    | 0.2677   | 0.8410 |

- ì¼ë¶€ ê³µì •ì—ì„œëŠ” RÂ²ê°€ ìŒìˆ˜ë¡œ ë‚˜ì˜¤ëŠ” ë“± ì˜ˆì¸¡ ì •í™•ë„ê°€ ë‚®ì€ ê²½ìš°ë„ ìžˆì—ˆì§€ë§Œ,  
  **ì „ì²´ì ì¸ ì†Œë¹„ íŒ¨í„´ê³¼ í”¼í¬ íƒ€ì´ë°ì€ ìž˜ í¬ì°©ë¨**.
- íŠ¹ížˆ 16pi Drillì˜ ê²½ìš° ê°€ìž¥ ë†’ì€ RÂ²(0.84)ë¥¼ ê¸°ë¡í•˜ë©°, ì‹¤ì œ ì†Œë¹„ ê³¡ì„ ì„ ìž˜ ìž¬í˜„í•¨.

> â€» RÂ² < 0ì¸ ê²½ìš°, ì˜ˆì¸¡ê°’ì´ í‰ê· ë³´ë‹¤ë„ ëª»í•œ ìˆ˜ì¤€ìž„ì„ ì˜ë¯¸í•˜ë©°,  
í•´ë‹¹ ê³µêµ¬ ì¡°ê±´ì—ì„œëŠ” ì¶”ê°€ì ì¸ í”¼ì²˜ ë³´ê°• ë˜ëŠ” ëª¨ë¸ íŠœë‹ì´ í•„ìš”í•©ë‹ˆë‹¤.



